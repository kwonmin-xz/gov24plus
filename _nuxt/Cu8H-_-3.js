import{a6 as u,q as c,r as o,a7 as y,a8 as g}from"./DSfHGzKa.js";const C=u("search",{state:()=>({searchApiUrl:c().public.searchApiUrl,query:"",headerQuery:"",realQuery:"",displayQuery:"",arkQuery:"",arkFlag:!0,collections:"IW_SERVICE,IW_RCV_SVC",startCount:0,listCount:10,currentPage:1,suggestions:[],headerSuggestions:[],searchApiResult:null,searchApiCategoryResult:null,relevantServiceApiResponse:null,totalCount:0,startDate:"",endDate:"",dateRange:"",dateRangeFlag:!0,dateSelectedFlag:!0,sortField:"RANK",togetherSvcFlag:!0,reQueryFlag:!0,reQueryCount:1,reQuery:"",reQueryTrue:"",reQueryFalse:"",recentQuerys:o([]),topicViewFlag:!1,applyFiltersMap:o(new Map),localSelectedCollectionValues:o([]),recommendUrlResult:{},recommendUrl:"",lrgCategory:"all",mdmCategory:"all",lrgCategoryCode:"all",mdmCategoryCode:"all",resetFlag:!0,itrstSrvcKey:0,modalCn:"",paginationFlag:!1,combinedValuesBackUp:"",routePath:""}),actions:{resetStore(){this.searchApiUrl=c().public.searchApiUrl,this.query="",this.headerQuery="",this.realQuery="",this.displayQuery="",this.arkQuery="",this.collections="IW_SERVICE,IW_RCV_SVC",this.startCount=0,this.listCount=10,this.currentPage=1,this.suggestions=[],this.headerSuggestions=[],this.searchApiResult=null,this.searchApiCategoryResult=null,this.relevantServiceApiResponse=null,this.totalCount=0,this.startDate="",this.endDate="",this.dateRange="",this.dateRangeFlag=!0,this.dateSelectedFlag=!0,this.sortField="RANK",this.togetherSvcFlag=!0,this.reQueryFlag=!0,this.reQueryCount=1,this.reQuery="",this.reQueryTrue="",this.reQueryFalse="",this.topicViewFlag=!1,this.applyFiltersMap=new Map,this.localSelectedCollectionValues=[],this.recommendUrlResult={},this.recommendUrl="",this.lrgCategory="all",this.mdmCategory="all",this.lrgCategoryCode="all",this.mdmCategoryCode="all",this.resetFlag=!0,this.itrstSrvcKey=0,this.modalCn="",this.combinedValuesBackUp="",this.routePath=""},setSessionStorage(){const e=JSON.stringify({query:this.query,realQuery:this.realQuery,collections:this.collections,startCount:this.startCount.toString(),listCount:this.listCount.toString(),currentPage:this.currentPage.toString(),sortField:this.sortField,applyFiltersMap:JSON.stringify([...this.applyFiltersMap]),localSelectedCollectionValues:JSON.stringify(this.localSelectedCollectionValues),dateRange:this.dateRange,startDate:this.startDate,endDate:this.endDate,lrgCategory:this.lrgCategory,mdmCategory:this.mdmCategory,lrgCategoryCode:this.lrgCategoryCode,mdmCategoryCode:this.mdmCategoryCode,togetherSvcFlag:JSON.stringify(this.togetherSvcFlag),reQueryTrue:this.reQueryTrue,reQueryFalse:this.reQueryFalse,reQueryCount:this.reQueryCount.toString(),combinedValuesBackUp:this.combinedValuesBackUp});sessionStorage.setItem("SearchStore",e)},getSessionStorage(){const e=sessionStorage.getItem("SearchStore");if(e){const t=JSON.parse(e);this.query=t.query||"",this.realQuery=t.realQuery||"",this.collections=t.collections||"IW_SERVICE,IW_RCV_SVC",this.startCount=Number(t.startCount)||0,this.listCount=Number(t.listCount)||10,this.currentPage=Number(t.currentPage)||1,this.sortField=t.sortField||"RANK",this.applyFiltersMap=new Map(JSON.parse(t.applyFiltersMap||"")),this.localSelectedCollectionValues=JSON.parse(t.localSelectedCollectionValues||""),this.dateRange=t.dateRange||"",this.startDate=t.startDate||"",this.endDate=t.endDate||"",this.lrgCategory=t.lrgCategory||"all",this.mdmCategory=t.mdmCategory||"all",this.lrgCategoryCode=t.lrgCategoryCode||"all",this.mdmCategoryCode=t.mdmCategoryCode||"all",this.togetherSvcFlag=JSON.parse(t.togetherSvcFlag||""),this.reQueryTrue=t.reQueryTrue||"",this.reQueryFalse=t.reQueryFalse||"",this.reQueryCount=Number(t.reQueryCount)||1,this.combinedValuesBackUp=t.combinedValuesBackUp||""}this.routePath!="/"&&this.routePath!="header"&&(this.routePath="",this.fetchSearchResult(),this.fetchSearchCategoryResult())},async resetSearchOption(){this.setCollection(this.collections),this.getSelectCollections(this.collections),this.resetReQuery(),this.setLocalSelectedCollectionValues(this.collections.split(",")),this.setLrgCategory("all"),this.setMdmCategory("all"),this.setLrgCategoryCode("all"),this.setMdmCategoryCode("all"),this.addApplyFilters("lrgCategory","all"),this.addApplyFilters("mdmCategory","all")},async resetFilter(){this.setCollection(this.collections),this.applyFiltersMap.clear(),this.getSelectCollections(this.collections),this.setDateRange(""),this.setStartDate(""),this.setEndDate(""),this.resetReQuery(),this.setLocalSelectedCollectionValues(this.collections.split(",")),this.setLrgCategory("all"),this.setMdmCategory("all"),this.setLrgCategoryCode("all"),this.setMdmCategoryCode("all"),this.addApplyFilters("lrgCategory","all"),this.addApplyFilters("mdmCategory","all")},async fetchSearchResult(){const e=this.query;this.paginationFlag?this.reQueryFalse!=""||this.reQueryTrue!=""?this.query=this.realQuery.replace(" "+this.reQueryTrue.replace(/,\s*$/,"").replaceAll(","," "),"").replace("!"+this.reQueryFalse.replace(/,\s*$/,"").replaceAll(","," !"),""):this.query=this.realQuery:(this.realQuery=e,this.displayQuery=e);const t=o([""]);if(t.value=this.reQuery.split(",").map(i=>i.trim()).filter(i=>i!==""),this.reQueryFlag==!0&&this.reQuery!=""){if(t.value.length>0)for(let i=0;i<t.value.length;i++)this.reQueryTrue+=t.value[i]+",",this.addApplyFilters("reQuery"+this.reQueryCount,"(포함)"+t.value[i]),this.reQueryCount=this.reQueryCount+1}else if(this.reQueryFlag==!1&&this.reQuery!=""&&t.value.length>0)for(let i=0;i<t.value.length;i++)this.reQueryFalse+=t.value[i]+",",this.addApplyFilters("reQuery"+this.reQueryCount,"(미포함)"+t.value[i]),this.reQueryCount=this.reQueryCount+1;this.reQueryTrue!=""&&!this.paginationFlag&&(this.realQuery+=" "+this.reQueryTrue.replace(/,\s*$/,"").replaceAll(","," "),this.displayQuery+=" (포함)"+this.reQueryTrue,this.displayQuery=this.displayQuery.replace(/,+$/,"")),this.reQueryFalse!=""&&!this.paginationFlag&&(this.realQuery+=" !"+this.reQueryFalse.replace(/,\s*$/,"").replaceAll(","," !"),this.displayQuery+=" (미포함)"+this.reQueryFalse,this.displayQuery=this.displayQuery.replace(/,+$/,""));const s=this.startCount.toString(),l=this.listCount.toString();let r="RANK/DESC,UID/ASC";this.sortField!=""&&(this.sortField=="RANK"?r="WEIGHT/DESC,RANK/DESC,UID/ASC":this.sortField=="DATE"?r="DATE/DESC,WEIGHT/DESC,RANK/DESC,UID/ASC":this.sortField=="VIEW"&&(this.collections==="IW_SERVICE"||this.collections==="IW_RCV_SVC"||this.collections==="IW_SERVICE,IW_RCV_SVC"?r="INQ_CNT/DESC,WEIGHT/DESC,RANK/DESC,UID/ASC":r="WEIGHT/DESC,RANK/DESC,UID/ASC"));const n=this.searchApiUrl+"/search/mergeResult";this.searchApiResult=await $fetch(n,{method:"post",body:{query:this.realQuery,startCount:s,listCount:l,collections:this.collections,startDate:this.startDate,endDate:this.endDate,sortField:r,lCategory:this.lrgCategoryCode,mCategory:this.mdmCategoryCode}});const h=this.searchApiResult.totalCount;h>0&&(this.totalCount=h);const a=y();a.setCurrentPage(this.currentPage),a.setListCount(this.listCount),a.setStartCount(this.startCount),a.setTotalCount(this.totalCount),a.setPagination(),h==0&&this.fetchRecommendUrl(),h>0&&this.query!=""&&this.addRecentQuery(this.query),this.paginationFlag=!1,this.setSessionStorage()},async fetchSearchCategoryResult(){const e=this.realQuery,t="IW_SERVICE,IW_RCV_SVC,OGV_TN_CNSTEXHB,OGV_TN_LNK_NEWS_LOCAL,OGV_TN_WEBAPP,OGV_PI_PD,OGV_PI_PN,OGV_PI_RR,OGV_PI_PU,OGV_QUESTION,OGV_N_MENU,RECOMMEND_KEYWORD",s=this.searchApiUrl+"/search/result";this.searchApiCategoryResult=await $fetch(s,{method:"post",body:{query:e,startCount:"0",listCount:"1",collections:t,startDate:this.startDate,endDate:this.endDate,sortField:"RANK/DESC",lCategory:this.lrgCategoryCode,mCategory:this.mdmCategoryCode}});const l=this.searchApiCategoryResult.totalCount;l>0&&(this.totalCount=l)},async fetchSuggestions(){var s;if(!this.arkQuery){this.suggestions=[];return}const e=this.searchApiUrl+"/search/getTransPage",t=await $fetch(e,{method:"post",body:{query:this.arkQuery}});(t!=null||t!=null)&&(this.suggestions=(s=t==null?void 0:t.result[0])==null?void 0:s.items,this.suggestions==null&&(this.suggestions=[]))},async fetchHeaderSuggestions(){var s;if(!this.arkQuery){this.headerSuggestions=[];return}const e=this.searchApiUrl+"/search/getTransPage",t=await $fetch(e,{method:"post",body:{query:this.arkQuery}});(t!=null||t!=null)&&(this.headerSuggestions=(s=t==null?void 0:t.result[0])==null?void 0:s.items,this.headerSuggestions==null&&(this.headerSuggestions=[]))},async fetchRecommendUrl(){const e=this.searchApiUrl+"/search/getTransPage";this.recommendUrlResult=await $fetch(e,{method:"post",body:{query:this.query,label:"_ALL_",target:"recommend",charset:"utf-8",datatype:"json"}})},async fetchRelevantService(){if(this.relevantServiceApiResponse=null,this.arkQuery.length>0){const e=this.searchApiUrl+"/search/result";this.relevantServiceApiResponse=await $fetch(e,{method:"post",body:{query:this.arkQuery,collections:"IW_SERVICE",listCount:"3",sortField:"RANK/DESC,INQ_CNT/DESC,TYPE_SN/ASC,SRVC_NM_SORT/ASC,UID/ASC",searchField:"SRVC_NM,SRVC_NM_LIKE,PRCS_TYPE_NM,SRVC_NM_CHO,PRCS_TYPE_NM_LIKE,PRCS_TYPE_NM_CHO",pageType:"relevantSvc"}})}},updateDate(e){const t=g();let s;switch(e){case"1M":s=t.subtract(1,"month");break;case"3M":s=t.subtract(3,"month");break;case"6M":s=t.subtract(6,"month");break;case"1Y":s=t.subtract(1,"year");break;default:s=t}this.startDate=s.format("YYYY/MM/DD"),this.endDate=t.format("YYYY/MM/DD"),this.addApplyFilters("dateRange",e.replace("M","개월").replace("Y","년"))},updateSelectedDate(){const e=this.startDate.replaceAll("/",".")+" ~ "+this.endDate.replaceAll("/",".");this.addApplyFilters("dateSelect",e)},setDateRangeFlag(e){this.dateRangeFlag=e},setDateSelectedFlag(e){this.dateSelectedFlag=e},resetDateRange(){this.setStartDate(""),this.setEndDate(""),this.setDateRange("")},getSelectCollections(e){const t=e.split(",").map(s=>s.trim());return t.includes("IW_SERVICE")&&this.addApplyFilters("collection01","민원서비스"),t.includes("IW_RCV_SVC")&&this.addApplyFilters("collection02","맞춤형혜택"),t.includes("OGV_TN_CNSTEXHB")&&this.addApplyFilters("collection03","기관정보"),t.includes("OGV_PI_PD")&&this.addApplyFilters("collection04","정책정보"),t.includes("OGV_QUESTION")&&this.addApplyFilters("collection05","자주묻는질문"),t.includes("OGV_N_MENU")&&this.addApplyFilters("collection06","사이트메뉴명"),t},getResultCount(e){const t=o([]);t.value=e.split(",");let s=0;for(let l=0;l<t.value.length;l++)this.searchApiCategoryResult&&(s+=this.searchApiCategoryResult.resultCount[t.value[l]]);return s},addApplyFilters(e,t){switch(e){case"collection01":t="민원서비스",this.applyFiltersMap.set(e,t);break;case"collection02":t="맞춤형혜택",this.applyFiltersMap.set(e,t);break;case"collection03":t="기관정보",this.applyFiltersMap.set(e,t);break;case"collection04":t="정책정보",this.applyFiltersMap.set(e,t);break;case"collection05":t="자주묻는질문",this.applyFiltersMap.set(e,t);break;case"collection06":t="사이트메뉴명",this.applyFiltersMap.set(e,t);break;case"dateRange":this.applyFiltersMap.delete("dateSelect"),this.applyFiltersMap.set(e,t);break;case"dateSelect":this.applyFiltersMap.delete("dateRange"),this.applyFiltersMap.set(e,t);break;case"lrgCategory":this.applyFiltersMap.delete("lrgCategory"),t!="all"?this.applyFiltersMap.set(e,"대분류 : "+t):this.applyFiltersMap.delete("mdmCategory");break;case"mdmCategory":this.applyFiltersMap.delete("mdmCategory"),t!="all"&&this.applyFiltersMap.set(e,"중분류 : "+t);break;case"reQuery"+this.reQueryCount:this.applyFiltersMap.set(e,t);break;default:this.applyFiltersMap.set(e,t)}},async deleteApplyFilters(e){var t,s;switch(e.includes("reQuery")&&(this.reQueryTrue=this.reQueryTrue.replaceAll(((t=this.applyFiltersMap.get(e))==null?void 0:t.replace("(포함)",""))+",",""),this.reQueryFalse=this.reQueryFalse.replaceAll(((s=this.applyFiltersMap.get(e))==null?void 0:s.replace("(미포함)",""))+",","")),this.applyFiltersMap.delete(e),e){case"collection01":this.setCollection(this.collections.replaceAll("IW_SERVICE","").split(",").filter(l=>l.trim()!=="").join(",")),this.setLocalSelectedCollectionValues(this.collections.split(","));break;case"collection02":this.setCollection(this.collections.replaceAll("IW_RCV_SVC","").split(",").filter(l=>l.trim()!=="").join(",")),this.setLocalSelectedCollectionValues(this.collections.split(","));break;case"collection03":this.setCollection(this.collections.replaceAll("OGV_TN_CNSTEXHB","").replaceAll("OGV_TN_LNK_NEWS_LOCAL","").replaceAll("OGV_TN_WEBAPP","").split(",").filter(l=>l.trim()!=="").join(",")),this.setLocalSelectedCollectionValues(this.collections.split(","));break;case"collection04":this.setCollection(this.collections.replaceAll("OGV_PI_PD","").replaceAll("OGV_PI_PN","").replaceAll("OGV_PI_PU","").replaceAll("OGV_PI_RR","").split(",").filter(l=>l.trim()!=="").join(",")),this.setLocalSelectedCollectionValues(this.collections.split(","));break;case"collection05":this.setCollection(this.collections.replaceAll("OGV_QUESTION","").split(",").filter(l=>l.trim()!=="").join(",")),this.setLocalSelectedCollectionValues(this.collections.split(","));break;case"collection06":this.setCollection(this.collections.replaceAll("OGV_N_MENU","").split(",").filter(l=>l.trim()!=="").join(",")),this.setLocalSelectedCollectionValues(this.collections.split(","));break}(e=="collection03"||e=="collection04")&&!this.applyFiltersMap.has("collection03")&&!this.applyFiltersMap.has("collection04")&&(this.dateSelectedFlag=!1,this.resetDateRange(),this.applyFiltersMap.delete("dateRange"),this.applyFiltersMap.delete("dateSelect")),e=="dateRange"&&this.resetDateRange(),e=="dateSelect"&&(this.dateSelectedFlag=!1,this.resetDateRange()),e=="lrgCategory"&&(this.setLrgCategory("all"),this.setMdmCategory("all"),this.setLrgCategoryCode("all"),this.setMdmCategoryCode("all"),this.applyFiltersMap.delete("mdmCategory")),e=="mdmCategory"&&(this.setMdmCategory("all"),this.setMdmCategoryCode("all")),e=="togetherSvcFlag"&&(this.togetherSvcFlag==!1?this.setTogetherSvcFlag(!0):this.setTogetherSvcFlag(!1)),this.applyFiltersMap.size==0,this.setLocalSelectedCollectionValues(this.collections.split(",")),this.fetchSearchResult(),this.fetchSearchCategoryResult()},resetApplyFilter(){this.applyFiltersMap.clear(),this.getSelectCollections("IW_SERVICE,IW_RCV_SVC"),this.setCollection("IW_SERVICE,IW_RCV_SVC"),this.setLocalSelectedCollectionValues(this.collections.split(",")),this.setTogetherSvcFlag(!0),this.resetDateRange(),this.resetReQuery(),this.startCount=0,this.currentPage=1,this.fetchSearchResult(),this.fetchSearchCategoryResult()},getApplyFilters(){return this.applyFiltersMap},setApplyFilters(e){this.applyFiltersMap=e},setApplyCollections(e,t){const s=this.collections.split(","),l=t.split(",");for(let r=0;r<l.length;r++)if(s.includes(l[r])){this.deleteApplyFilters("collection"+e);break}else{this.addApplyFilters("collection"+e,t);break}},addRecentQuery(e){this.recentQuerys.includes(e)?this.recentQuerys.includes(e)&&(this.recentQuerys.splice(this.recentQuerys.indexOf(e),1),this.recentQuerys.unshift(e)):this.recentQuerys.unshift(e),this.recentQuerys.length>10&&this.recentQuerys.pop(),localStorage.setItem("recentQuerys",JSON.stringify(this.recentQuerys))},removeRecentQuery(e){this.recentQuerys=this.recentQuerys.filter(t=>t!==e),localStorage.setItem("recentQuerys",JSON.stringify(this.recentQuerys))},clearRecentQuery(){this.recentQuerys=[],localStorage.removeItem("recentQuerys")},loadFromLocalStorage(){const e=localStorage.getItem("recentQuerys");e&&(this.recentQuerys=JSON.parse(e))},setQueryParam(e){e.srhQuery!=null&&(this.query=e.srhQuery),e.collections!=null&&(this.collections=e.collections),e.sortField!=null&&(this.sortField=e.sortField),e.dateRange!=null&&(this.dateRange=e.dateRange,this.updateDate(this.dateRange))},setQuery(e){this.query=e},setHeaderQuery(e){this.headerQuery=e},resetHeaderQuery(){this.headerQuery="",this.headerSuggestions=[]},setRealQuery(e){this.realQuery=e,this.reQuery=e,this.reQueryTrue=e,this.reQueryFalse=e},resetReQuery(){this.setReQueryFlag(!0),this.reQuery="",this.reQueryTrue="",this.reQueryFalse=""},setDisplayQuery(e){this.displayQuery=e},setArkQuery(e){this.arkQuery=e},setArkFlag(e){this.arkFlag=e},setReQueryFlag(e){this.reQueryFlag=e},setReQuery(e){this.reQuery=e},setCollection(e){this.collections=e},setStartDate(e){this.startDate=e},setEndDate(e){this.endDate=e},setDateRange(e){this.dateRange=e},setStartCount(e){this.startCount=e},setListCount(e){this.listCount=e},setCurrentPage(e){this.currentPage=e},setSortField(e){this.sortField=e},setLrgCategory(e){this.lrgCategory=e},setMdmCategory(e){this.mdmCategory=e},setLrgCategoryCode(e){this.lrgCategoryCode=e},setMdmCategoryCode(e){this.mdmCategoryCode=e},setTogetherSvcFlag(e){this.togetherSvcFlag=e},setTopicViewFlag(e){this.topicViewFlag=e},setLocalSelectedCollectionValues(e){let t=e.join(","),s=!1,l=!1;(t.includes("OGV_PI_")||t.includes("OGV_TN_"))&&(t.includes("OGV_PI_")&&(t=t.replaceAll("OGV_PI_PD","").replaceAll("OGV_PI_PN","").replaceAll("OGV_PI_PU","").replaceAll("OGV_PI_RR","").split(",").filter(r=>r.trim()!=="").join(","),s=!0),t.includes("OGV_TN_")&&(t=t.replaceAll("OGV_TN_CNSTEXHB","").replaceAll("OGV_TN_LNK_NEWS_LOCAL","").replaceAll("OGV_TN_WEBAPP","").split(",").filter(r=>r.trim()!=="").join(","),l=!0),e=t.split(",").filter(r=>r.trim()!==""),s&&e.push("OGV_PI_PD,OGV_PI_PN,OGV_PI_RR,OGV_PI_PU"),l&&e.push("OGV_TN_CNSTEXHB,OGV_TN_LNK_NEWS_LOCAL,OGV_TN_WEBAPP")),this.localSelectedCollectionValues=e},getLocalSelectedCollectionValues(){return this.localSelectedCollectionValues},setCombinedValuesBackUp(e){this.combinedValuesBackUp=e},setResetFlag(e){this.resetFlag=e},setItrstSrvcKey(){this.itrstSrvcKey=this.itrstSrvcKey+1},setModalCn(e){this.modalCn=e},async changePage(e){this.currentPage=e,this.startCount=(e-1)*this.listCount,this.paginationFlag=!0,await this.fetchSearchResult()}}});export{C as u};
